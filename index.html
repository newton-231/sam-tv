<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>SAMTV PRO - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</title>
    
    <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SAMTV">
    <meta name="theme-color" content="#000000">
    
    <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.10"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: #000000;
            color: #ffffff;
            height: 100vh;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #loginScreen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 20px;
        }
        
        .logo {
            font-size: 42px;
            color: #00aaff;
            margin-bottom: 40px;
            text-align: center;
        }
        
        .input-container {
            width: 90%;
            max-width: 320px;
            margin-bottom: 20px;
        }
        
        .input-container input {
            width: 100%;
            padding: 18px;
            background: #1c1c1e;
            color: #ffffff;
            border: 1px solid #333333;
            border-radius: 12px;
            font-size: 16px;
            text-align: center;
        }
        
        .login-button {
            width: 90%;
            max-width: 320px;
            padding: 18px;
            background: #00aaff;
            color: #000000;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .status {
            margin-top: 15px;
            color: #888888;
            font-size: 14px;
            text-align: center;
        }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
        #appScreen {
            display: none;
            height: 100vh;
            flex-direction: column;
        }
        
        .app-header {
            background: #1c1c1e;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .app-title {
            font-size: 18px;
            font-weight: bold;
            color: #00aaff;
        }
        
        .logout-button {
            background: #ff3b30;
            color: #ffffff;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        /* Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
        #videoPlayer {
            width: 100%;
            height: 250px;
            background: #000000;
            display: none;
        }
        
        /* Ø§Ù„Ù‚Ù†ÙˆØ§Øª */
        .channels-container {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }
        
        .channel-card {
            width: 140px;
            background: #1c1c1e;
            border-radius: 10px;
            overflow: hidden;
            margin: 5px;
            display: inline-block;
        }
        
        .channel-logo {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .channel-name {
            padding: 10px;
            text-align: center;
            font-size: 13px;
        }
    </style>
</head>
<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginScreen">
    <div class="logo">ğŸ“º SAMTV PRO</div>
    
    <div class="input-container">
        <input type="text" id="codeInput" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„">
    </div>
    
    <button class="login-button" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
    
    <div class="status" id="statusText">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø°ÙŠ Ø§Ø´ØªØ±ÙŠØªÙ‡ Ù…Ù† Ø§Ù„Ù…ÙˆØ²Ø¹</div>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
<div id="appScreen">
    <div class="app-header">
        <div class="app-title">ğŸ“º SAMTV PRO</div>
        <button class="logout-button" onclick="logout()">Ø®Ø±ÙˆØ¬</button>
    </div>
    
    <video id="videoPlayer" controls playsinline></video>
    
    <div class="channels-container" id="channelsList"></div>
</div>

<script>
// Ø¯Ø§Ù„Ø© ØªØ´ÙÙŠØ± XOR
function xorEncrypt(data) {
    const XOR_KEY = "123456";
    return btoa(data.split('').map((c, i) =>
        String.fromCharCode(c.charCodeAt(0) ^ XOR_KEY.charCodeAt(i % XOR_KEY.length))
    ).join(''));
}

// Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
async function login() {
    const codeInput = document.getElementById("codeInput");
    const statusText = document.getElementById("statusText");
    const code = codeInput.value.trim();
    
    if (!code) {
        alert("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„");
        return;
    }
    
    statusText.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯...";
    statusText.style.color = "#00aaff";
    
    try {
        // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const requestData = {
            code: code,
            action: "get_live"
        };
        
        // ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const encryptedData = xorEncrypt(JSON.stringify(requestData));
        
        // Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ SAMTV
        const response = await fetch('https://samtv4norm.d1d2.org/login.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'User-Agent': 'SAMTVPro/5.3 (Android; IPTV)',
                'X-Requested-With': 'com.samtv.app',
                'Connection': 'Keep-Alive'
            },
            body: `json=${encodeURIComponent(encryptedData)}`
        });
        
        const result = await response.json();
        
        if (result.status === "success") {
            // Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯
            localStorage.setItem("samtv_code", code);
            localStorage.setItem("samtv_channels", JSON.stringify(result.list || []));
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ø´Ø§Ø´Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            document.getElementById("loginScreen").style.display = "none";
            document.getElementById("appScreen").style.display = "flex";
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
            displayChannels(result.list || []);
            
            statusText.textContent = "âœ… ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!";
            statusText.style.color = "#00ff00";
            
            // Ø¥Ø±Ø´Ø§Ø¯ Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            setTimeout(() => {
                alert("ğŸ“± Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:\n\n1. Ø§Ù†Ù‚Ø± Ø²Ø± Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø³ÙØ§Ø±ÙŠ\n2. Ø§Ø®ØªØ± 'Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©'\n3. Ø§Ù†Ù‚Ø± 'Ø¥Ø¶Ø§ÙØ©'\n\nâœ… Ø³ÙŠØ¸Ù‡Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙƒØ£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø«Ù„ Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª!");
            }, 1000);
            
        } else {
            statusText.textContent = "âŒ " + (result.message || "ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­");
            statusText.style.color = "#ff3b30";
        }
        
    } catch (error) {
        statusText.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ SAMTV";
        statusText.style.color = "#ff3b30";
        console.error("Error details:", error);
    }
}

// Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
function displayChannels(channels) {
    const container = document.getElementById("channelsList");
    
    if (!channels || channels.length === 0) {
        container.innerHTML = '<div style="text-align:center; padding:40px; color:#888;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ù†ÙˆØ§Øª Ù…ØªØ§Ø­Ø©</div>';
        return;
    }
    
    let html = '';
    
    channels.forEach(channel => {
        html += `
            <div class="channel-card" onclick="playChannel('${channel.url}', '${channel.name}')">
                <img src="${channel.logo || ''}" 
                     class="channel-logo"
                     onerror="this.src='https://via.placeholder.com/140x150/333/fff?text=${channel.name.substring(0, 10)}'"
                     alt="${channel.name}">
                <div class="channel-name">${channel.name}</div>
            </div>
        `;
    });
    
    container.innerHTML = html;
}

// Ø¯Ø§Ù„Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø©
function playChannel(url, name) {
    const player = document.getElementById("videoPlayer");
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø´ØºÙ„
    player.style.display = "block";
    
    // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(url);
        hls.attachMedia(player);
        player.play();
    } else if (player.canPlayType('application/vnd.apple.mpegurl')) {
        player.src = url;
        player.play();
    } else {
        alert("âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ");
    }
}

// Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
function logout() {
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŸ")) {
        localStorage.removeItem("samtv_code");
        localStorage.removeItem("samtv_channels");
        location.reload();
    }
}

// Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ ØªØ­Ù‚Ù‚ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙØ¹Ù„
window.onload = function() {
    const savedCode = localStorage.getItem("samtv_code");
    const savedChannels = localStorage.getItem("samtv_channels");
    
    if (savedCode && savedChannels) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("appScreen").style.display = "flex";
        
        const channels = JSON.parse(savedChannels);
        displayChannels(channels);
        
        document.getElementById("statusText").textContent = "âœ… Ø¬Ù„Ø³Ø© Ù…ÙØ¹Ù„Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹";
    }
    
    // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
    document.getElementById("codeInput").addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            login();
        }
    });
};
</script>
</body>
</html>
