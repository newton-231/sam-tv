<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SAMTV</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family: sans-serif; }
        body { background:#000; color:#fff; text-align:center; padding:50px; }
        input, button { padding:15px; margin:10px; border-radius:10px; font-size:16px; }
        input { width:300px; background:#222; color:#fff; border:1px solid #444; }
        button { background:#0af; color:#000; border:none; font-weight:bold; cursor:pointer; }
    </style>
</head>
<body>

<h1>ðŸ“º SAMTV</h1>
<input id="code" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„">
<button onclick="testConnection()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</button>
<div id="result" style="margin-top:20px;"></div>

<script>
async function testConnection() {
    const code = document.getElementById('code').value || "29319bd15409c675dc2c942946ff972e9a254c43";
    const result = document.getElementById('result');
    
    result.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...";
    
    try {
        // 1. Ø§Ø®ØªØ¨Ø§Ø± ØªØ´ÙÙŠØ± XOR
        const encrypted = xorEncrypt(JSON.stringify({
            code: code,
            action: "get_live"
        }));
        
        // 2. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±
        const response = await fetch('https://samtv4norm.d1d2.org/login.php', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'User-Agent': 'SAMTVPro/5.3 (Android; IPTV)'
            },
            body: `json=${encodeURIComponent(encrypted)}`
        });
        
        const data = await response.json();
        
        if(data.status === "success") {
            result.innerHTML = `âœ… Ù†Ø¬Ø§Ø­! ØªÙ… Ø¬Ù„Ø¨ ${data.list?.length || 0} Ù‚Ù†Ø§Ø©`;
            console.log("Ø§Ù„Ù‚Ù†ÙˆØ§Øª:", data.list);
        } else {
            result.innerHTML = `âŒ ÙØ´Ù„: ${data.message || "ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­"}`;
        }
    } catch(error) {
        result.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
        console.error("ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø£:", error);
    }
}

function xorEncrypt(data) {
    const XOR_KEY = "123456";
    return btoa(data.split('').map((c, i) =>
        String.fromCharCode(c.charCodeAt(0) ^ XOR_KEY.charCodeAt(i % XOR_KEY.length))
    ).join(''));
}
</script>
</body>
</html>
